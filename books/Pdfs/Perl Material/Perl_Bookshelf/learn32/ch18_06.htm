<HTML
><HEAD
>
<TITLE>[Chapter 18] 18.6 Troubleshooting CGI Programs</TITLE>
<META
NAME="DC.title"
CONTENT="Learning Perl on Win32 Systems"><META
NAME="DC.creator"
CONTENT="Randal L. Schwartz, Erik Olson &amp; Tom Christiansen"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1999-07-02T01:37:00Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-324-3"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch18_01.htm"
TITLE="18. CGI Programming"><LINK
REL="prev"
HREF="ch18_05.htm"
TITLE="18.5 Creating a Guestbook Program"><LINK
REL="next"
HREF="ch18_07.htm"
TITLE="18.7 Perl and the Web: Beyond CGI Programming"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="Learning Perl on Win32 Systems"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,54"
HREF="index.htm"
ALT="Learning Perl on Win32 Systems"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="../search/wsrch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch18_05.htm"
TITLE="18.5 Creating a Guestbook Program"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 18.5 Creating a Guestbook Program"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
><A
CLASS="chapter"
REL="up"
HREF="ch18_01.htm"
TITLE="18. CGI Programming"
>Chapter 18<BR><A
CLASS="indexterm"
NAME="ch18-idx-87413-0"
></A
>CGI Programming</A
></FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch18_07.htm"
TITLE="18.7 Perl and the Web: Beyond CGI Programming"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 18.7 Perl and the Web: Beyond CGI Programming"
BORDER="0"></A
></TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="sect1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="ch18-12946"
>18.6 Troubleshooting CGI Programs</A
></H2
><P
CLASS="para"
>CGI programs launched from a web server run under a fundamentally different environment than they do when invoked from the command line. While you should always verify that your CGI program runs properly from the command line,[<A
CLASS="footnote"
HREF="#ch18-pgfId-87039"
>15</A
>] this isn't enough to guarantee that your program will work when called from the web server. </P
><BLOCKQUOTE
CLASS="footnote"
><DIV
CLASS="footnote"
><P
CLASS="para"
><A
CLASS="footnote"
NAME="ch18-pgfId-87039"
>[15]</A
> See the <EM
CLASS="emphasis"
>CGI.pm</EM
> documentation for tips on command-line debugging. </P
></DIV
></BLOCKQUOTE
><P
CLASS="para"
>You should get the CGI programming FAQ and a good book on CGI programming to help you in this. Some of these references are listed at the end of this chapter. Here's a brief list of the frequent problems that arise in CGI programming. Almost all of them trigger those annoyingly unhelpful <CODE
CLASS="literal"
>500 Server Error </CODE
>messages that you will soon come to know and hate. </P
><UL
CLASS="itemizedlist"
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87041"
></A
>If, when sending HTML to a browser, you forget the blank line between the HTTP header (that is, the Content-Type line) and the body, your program won't work. Remember to output a proper Content-Type line (and possibly other HTTP headers) plus a totally blank line before you do anything else. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87042"
></A
>The server needs to be able to read and execute the script, so you need to make sure that whatever user your script runs as (e.g., IUSR_MYSERVER under IIS) has read and execute rights to the script. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87043"
></A
>The directory where the script resides must have read and execute rights for the script user.</P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87044"
></A
>The script must be installed in the proper directory for your server configuration. For example, on some systems, the directory may be <EM
CLASS="emphasis"
>c:\inetpub\scripts</EM
>.[<A
CLASS="footnote"
HREF="#ch18-pgfId-88973"
>16</A
>] </P
><BLOCKQUOTE
CLASS="footnote"
><DIV
CLASS="footnote"
><P
CLASS="para"
><A
CLASS="footnote"
NAME="ch18-pgfId-88973"
>[16]</A
> This directory is the default for IIS, Microsoft's Internet Information Server.</P
></DIV
></BLOCKQUOTE
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87048"
></A
>You need to have your script's filename end in a particular suffix, like <EM
CLASS="emphasis"
>.cgi</EM
> or <EM
CLASS="emphasis"
>.plx</EM
>, so that your web server knows that it needs to invoke the Perl interpreter on your script. Make sure that your script directory is not writable by FTP clients. We suggest using a suffix of <EM
CLASS="emphasis"
>.plx</EM
>, and associating <EM
CLASS="emphasis"
>.plx</EM
> with your Perl interpreter. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87049"
></A
>Your server configuration requires CGI execution specially enabled for the directory you put your CGI script in. Make sure both <CODE
CLASS="literal"
>GET</CODE
> and <CODE
CLASS="literal"
>POST</CODE
> are allowed. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87050"
></A
>Normally, the web server doesn't execute your script using your account. Make sure the files and directories accessed by the script are open to whatever user the script will run as; this might be the IUSR_INTERNET or <CODE
CLASS="replaceable"
><I
>anoynmous</I
></CODE
> account, or whatever account you use on your system. You may need to pre-create such files and directories and give them appropriate permissions. Always be alert to the risks when you grant such access to files. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87051"
></A
>Always run your script under Perl's <CODE
CLASS="literal"
>-w</CODE
> flag to get warnings. These warnings go to the web server error log, which contains any errors and warnings generated by your script. Learn the path to that logfile from your webmaster and check it for problems. See also the standard <CODE
CLASS="literal"
>CGI::Carp</CODE
> module for how to handle errors better. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87052"
></A
>Make sure that the versions and paths to Perl and any libraries you use (like <EM
CLASS="emphasis"
>CGI.pm</EM
>) are what you're expecting them to be over on the machine the web server is running on. </P
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87053"
></A
>Enable <CODE
CLASS="literal"
>autoflush</CODE
> on the STDOUT filehandle at the top of your script by setting the <CODE
CLASS="literal"
>$|</CODE
> variable to a true value, like one. If you've used the <CODE
CLASS="literal"
>FileHandle</CODE
> module or any of the IO modules (like <CODE
CLASS="literal"
>IO::File</CODE
>, <CODE
CLASS="literal"
>IO::Socket</CODE
>, and so on), then you can use the more mnemonically named <CODE
CLASS="literal"
>autoflush()</CODE
> method on the filehandle instead: </P
><PRE
CLASS="programlisting"
>     use FileHandle;
<CODE
CLASS="literal"
>     STDOUT-&gt;autoflush(1);</CODE
></PRE
></LI
><LI
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="listitem"
NAME="ch18-pgfId-87056"
></A
>Check the return value of every system call your program makes, and take appropriate action if the call fails. </P
></LI
></UL
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch18_05.htm"
TITLE="18.5 Creating a Guestbook Program"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 18.5 Creating a Guestbook Program"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="Learning Perl on Win32 Systems"
><IMG
SRC="../gifs/txthome.gif"
ALT="Learning Perl on Win32 Systems"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch18_07.htm"
TITLE="18.7 Perl and the Web: Beyond CGI Programming"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 18.7 Perl and the Web: Beyond CGI Programming"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>18.5 Creating a Guestbook Program</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>18.7 Perl and the Web: Beyond CGI Programming</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><P
CLASS="nav"
><FONT
SIZE="-1"
>[ <A
HREF="../index.htm"
TITLE="The Perl CD Bookshelf"
>Library Home</A
> | <A
HREF="../perlnut/index.htm"
TITLE="Perl in a Nutshell"
>Perl in a Nutshell</A
> | <A
HREF="../learn/index.htm"
TITLE="Learning Perl"
>Learning Perl</A
> | <A
HREF="index.htm"
TITLE="Learning Perl on Win32 Systems"
>Learning Perl on Win32</A
> | <A
HREF="../prog/index.htm"
TITLE="Programming Perl"
>Programming Perl</A
> | <A
HREF="../advprog/index.htm"
TITLE="Advanced Perl Programming"
>Advanced Perl Programming</A
> | <A
HREF="../cookbook/index.htm"
TITLE="Perl Cookbook"
>Perl Cookbook</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
